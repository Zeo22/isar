@using ISAR.Models;
@model ISAR.Models.Indicador

@{
    ViewBag.Title = "Detalle de Indicador";
    switch ((string)ViewBag.Nivel)
    {
        case "1":
            ViewBag.Grupo = "Nivel Superior";
            ViewBag.Pantalla = ViewBag.Title;
            break;
        case "2":
            ViewBag.Grupo = "Nivel Vicepresidencia";
            ViewBag.Pantalla = ViewBag.Title;
            break;
        case "3":
            ViewBag.Grupo = "Nivel Operativo";
            ViewBag.Pantalla = ViewBag.Title;
            break;
    }
}

<h4>@ViewBag.Title</h4>


@Html.AntiForgeryToken()
@Html.Hidden("lvl", (string)ViewBag.Nivel)

<ul class="nav nav-tabs nav-tabs-simple">
    <li class="active">
        <a data-toggle="tab" href="#tabDefinicion">Definición</a>
    </li>
    <li>
        <a data-toggle="tab" href="#tabMetas">Meta y Resultados</a>
    </li>
</ul>
<div class="tab-content">
    <div class="tab-pane active" id="tabDefinicion">
        <div class="row">
            <div class="col-md-6">
                <div class="form-group form-group-default">
                    @Html.LabelFor(model => model.Nombre)
                    @Html.DisplayFor(model => model.Nombre, new { htmlAttributes = new { @class = "form-control" } })
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group form-group-default">
                    @Html.LabelFor(model => model.Tipo)
                    @Html.DisplayFor(model => model.Tipo.Nombre, new { htmlAttributes = new { @class = "form-control" } })
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <div class="panel-title">
                            Descripción
                        </div>
                    </div>
                    <div class="panel-body">
                        @Html.DisplayFor(model => model.Descripcion, new { htmlAttributes = new { @class = "form-control" } })
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group form-group-default">
                    @Html.LabelFor(model => model.Frecuencia)
                    @Html.DisplayFor(model => model.Frecuencia.Nombre, new { htmlAttributes = new { @class = "form-control" } })
                </div>

                <div class="panel panel-default">
                    <div class="panel-heading">
                        <div class="panel-title">
                            Fórmula
                        </div>
                    </div>
                    <div class="panel-body">
                        @Html.DisplayFor(model => model.Formula, new { htmlAttributes = new { @class = "form-control" } })
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group form-group-default">
                    @Html.LabelFor(model => model.FechaInicio)
                    @Html.DisplayFor(model => model.FechaInicio, new { htmlAttributes = new { @class = "form-control" } })
                </div>

                <div class="form-group form-group-default">
                    @Html.LabelFor(model => model.FechaFinal)
                    @Html.DisplayFor(model => model.FechaFinal, new { htmlAttributes = new { @class = "form-control" } })
                </div>
            </div>
            <div class="col-md-6">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <div class="panel-title">
                            Fuente de Información
                        </div>
                    </div>
                    <div class="panel-body">
                        @Html.DisplayFor(model => model.FuenteInformacion, new { htmlAttributes = new { @class = "form-control" } })
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group form-group-default">
                    @Html.LabelFor(model => model.UnidadDeMedida)
                    @Html.DisplayFor(model => model.UnidadDeMedida.Nombre, new { htmlAttributes = new { @class = "form-control" } })
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group form-group-default">
                    @Html.LabelFor(model => model.Area)
                    @Html.DisplayFor(model => model.Area.Nombre, new { htmlAttributes = new { @class = "form-control" } })
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group form-group-default">
                    @Html.LabelFor(model => model.Comportamiento)
                    @Html.DisplayFor(model => model.Comportamiento.Nombre, new { htmlAttributes = new { @class = "form-control" } })
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group form-group-default">
                    @Html.LabelFor(model => model.Responsable)
                    @Html.DisplayFor(model => model.Responsable.Nombre, new { htmlAttributes = new { @class = "form-control" } })
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <div class="panel-title">
                            Umbrales
                        </div>
                    </div>
                    <div class="panel-body">
                        <i style="color:green" class="fa fa-circle"></i> @Html.DisplayFor(model => model.UmbralVerde.Desde) A @Html.DisplayFor(model => model.UmbralVerde.Hasta)<br>
                        <i style="color:yellow" class="fa fa-circle"></i> @Html.DisplayFor(model => model.UmbralAmarillo.Desde) A @Html.DisplayFor(model => model.UmbralAmarillo.Hasta)<br>
                        <i style="color:red" class="fa fa-circle"></i> @Html.DisplayFor(model => model.UmbralRojo.Desde) A @Html.DisplayFor(model => model.UmbralRojo.Hasta)<br>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="tab-pane" id="tabMetas">
        <div class="row">
            <div class="col-md-12">
                <table class="table" id="dtMetas">
                    <thead>
                        <tr>
                            <th>
                                Dia
                            </th>
                            <th>
                                Meta
                            </th>
                            <th>
                                Resultados
                            </th>
                            <th width="10" class="text-center">
                                Cerrar<br />Meta
                            </th>
                            <th width="10" class="text-center">
                                Cerrar<br />Resultado
                            </th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <a href="@Url.Action("index", new { lvl = ViewBag.Nivel })" class="btn btn-warning btn-cons">Regresar</a>
</div>

@section Scripts {
    @*@Scripts.Render("~/bundles/jqueryval")*@
    <script>
        $(document).ready(function () {
            var initial_data = @Html.Raw(ViewBag.Metas);

            var settings = {
                "sDom": "<'table-responsive't><'row'<'pull-right'p> <'pull-left'i>>",
                "sPaginationType": "bootstrap",
                "destroy": true,
                "scrollCollapse": true,
                "oLanguage": {
                    "sLengthMenu": "_MENU_ ",
                    "sInfo": "Mostrando items del <b>_START_ al _END_</b> de un total de _TOTAL_ items",
                    "sEmptyTable": "No existe información para mostrar.",
                    "sInfoEmpty": ""
                },
                "iDisplayLength": 10,
                "data": initial_data,
                "columns": [
                    { name: "Dia", data: 'inicio' },
                    { name: "Meta", data: "meta", render: function (data, type, full, meta) { return data + ' @Model.UnidadDeMedida.Nombre' } },
                    {
                        name: "Cerrar<br />Meta", data: "metaCerrada", className: "text-center", render: function (data, type, full, meta) {
                            if (data) {
                                return '<a href="javascript: $.noop();" style="color:red" class="fa fa-lock"></a>';
                            }
                            else {
                                return '<a href="javascript: $.noop();" style="color:green" class="fa fa-check cus-cerrarmeta"></a>';
                            }
                        }
                    },
                    {
                        name: "Cerrar<br />Resultado", data: "resultadoCerrado", className: "text-center", render: function (data, type, full, meta) {
                            if (data) {
                                return '<a href="javascript: $.noop();" style="color:red" class="fa fa-lock"></a>';
                            }
                            else {
                                return '<a href="javascript: $.noop();" style="color:green" class="fa fa-check cus-cerrarresulado"></a>';
                            }
                        }
                    }
                ]
            };

            $('#dtMetas').dataTable(settings);
        });
    </script>
}
